# Напишите функцию smart_cor, которая получает на вход dataframe с двумя количественными переменными. 
# Проверьте с помощью теста Шапиро-Уилка, что данные в обеих переменных принадлежат нормальному распределению.
# Если хотя бы в одном векторе распределение переменной отличается от нормального (p - value меньше 0.05), 
# то функция должна возвращать коэффициент корреляции Спирмена. (Числовой вектор из одного элемента).
# Если в обоих векторах распределение переменных от нормального значимо не отличается, то функция должна возвращать коэффициент корреляции Пирсона.

library(psych) #подключаем пакет psych для corr.tes.

smart_cor <- function(x){
x_numeric <- x[, sapply(x, is.numeric)] # очищяем data.frame от нечисловых значений и передаем их в проверку на нормальность распределения.
normal_result <- lapply(x_numeric, shapiro.test) # с помощью функции lapply проводим тест shapiro для всех данных фрейма. На выходе будет именной список с данными теста для каждой колонки.
normal_p_value <- unlist(lapply(normal_result, function(x) x$p.value)) # распаковываем список и забираем из него только p.value.
ifelse(normal_p_value[[1]]> 0.05 & normal_p_value[[2]]>0.05, return(corr.test(df,method="pearson")$r[2]), return(corr.test(df,method="spearman")$r[2])) # проверяем p.value и применяем соответственно тест Пирсона или Спирмена. Обращение через индекс c[[1]] для того, чтобы получить прямой доступ к самому p значению. Иначе в c[1] содержится имя переменной и само p значение.
}
